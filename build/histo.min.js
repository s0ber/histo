!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?exports.Histo=e(require("jquery")):t.Histo=e(t.jquery)}(this,function(t){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(e,n){e.exports=t},function(t,e,n){var i,r,o,a={}.hasOwnProperty;o=n(3),r=n(2),i=n(0),t.exports=function(){function t(){}return t.addWidget=function(e){var n;return null==e&&(e={}),this.isInitialized()||this.initialize(),n=new o(t,e),null==this.widgets&&(this.widgets={}),this.widgets[n.id]=n},t.initialize=function(){return this._isInitialized=!0,this._fakeStatePopped=!1,this._initialUrl=location.href,window.onpopstate=function(t){return function(e){return t._popState(null!=e?e.state:void 0)}}(this),window.onhashchange=function(t){return function(){return t.replaceStateWithCurrent()}}(this),this.saveInitialStateAsCurrent()},t.unload=function(){return this._isInitialized=!1,this._fakeStatePopped=!1,window.onpopstate=null,window.onhashchange=null},t.isInitialized=function(){return this._isInitialized},t.saveInitialStateAsCurrent=function(){return this.saveCurrentState(window.location.state||{})},t.currentState=function(){return this._currentState},t.saveCurrentState=function(t){return this._currentState=JSON.parse(JSON.stringify(t))},t.supplementState=function(t){var e,n,i,r,o,a;if(!this.isPopping)return n=t.id,a=t.widgetState,o=this._history().state||{},a.state_id=null!=(e=null!=(r=o[n])?r.state_id:void 0)?e:0,o[n]=a,i=t.path||location.href,this._history().replaceState(o,null,i),this.saveCurrentState(o)},t.replaceStateWithCurrent=function(){if(null==this._history().state)return this._history().replaceState(this.currentState(),null,location.href)},t.pushNewState=function(t,e){var n,i,r;return this._fakeStatePopped=!0,n=e.id,r=e.widgetState,r.state_id=this.currentState()[n].state_id+1,i=this.currentState(),i[n]=r,t=this._removeURIParameter(t,"_"),this._history().pushState(i,null,t),this.saveCurrentState(i)},t._getChangedWidgetId=function(t){var e,n,i,r,o,u;e=null;for(r in t)if(a.call(t,r)){u=t[r],o=this.currentState();for(n in o)if(a.call(o,n)&&(i=o[n],r===n&&u.state_id!==i.state_id&&1===Math.abs(u.state_id-i.state_id))){e=r;break}}return e},t._asyncFn=function(){return null!=this.__asyncFn?this.__asyncFn:this.__asyncFn=r},t._history=function(){return window.history},t._removeURIParameter=function(t,e){var n,i,r,o,a,u,s;if(t=t.toString(),s=t.split("?"),s.length<2)return t;for(a=encodeURIComponent(e)+"=",o=s[1].split(/[&;]/g),r=[],n=i=0,u=o.length;0<=u?i<u:i>u;n=0<=u?++i:--i)-1===o[n].lastIndexOf(a,0)&&r.push(o[n]);return t=r.length?s[0]+"?"+r.join("&"):s[0]},t._popState=function(t){var e,n,r,o,a;return location.href!==this._initialUrl||this._fakeStatePopped?(this._fakeStatePopped=!0,null!=(n=this._getChangedWidgetId(t))?(null!=this.currentChangedId&&this.currentChangedId===n&&null!=(o=this.dfd)&&o.reject(),this.currentChangedId=n,a=t[n],r=location.href,this.saveCurrentState(t),this.dfd=e=new i.Deferred,this._asyncFn().addToCallQueue(function(t){return function(){var i;return t.isPopping=!0,e.done(function(){return t.isPopping=!1}),i=t.widgets[n],i.callCallback(a,r,e),e.promise()}}(this))):void 0):void(this._fakeStatePopped=!0)},t}()},function(t,e,n){!function(e,i){t.exports=i(n(0))}(0,function(t){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){var i;i=n(2),t.exports=window.AsyncFn=function(){function t(t){this.dfd=new i.Deferred,this.fn=t}return t.prototype.done=function(t){if(this.callback=t,this.isCalled)return this.callback()},t.prototype.call=function(){if(!this.isCalled)return this.fn().always(function(t){return function(){if(t.isCalled=!0,t.dfd.resolve(),t.callback)return t.callback()}}(this))},t.addToCallQueue=function(e){var n;return n=new t(e),null!=this.currentFn?this.currentFn.done(function(){return n.call()}):n.call(),this.currentFn=n},t.setImmediate=function(){var t,e,n,i;return e={},i=e,t=Math.random(),n=function(n){var i;if(n.data.toString()===t.toString())return e=e.next,i=e.func,delete e.func,i()},window.addEventListener&&window.postMessage?(window.addEventListener("message",n,!1),function(e){return i=i.next={func:e},window.postMessage(t,"*")}):function(t){return setTimeout(t,0)}}(),t}()},function(e,n){e.exports=t}])})},function(t,e){t.exports=function(){function t(t,e){this.Histo=t,e.id&&(this.id=e.id,this.poppedStateCallback=null)}return t.prototype.onPopState=function(t){return this.poppedStateCallback=t},t.prototype.callCallback=function(t,e,n){if(null!=this.poppedStateCallback)return this.poppedStateCallback(t,e,n)},t.prototype.replaceInitialState=function(t,e){return null==e&&(e=location.href),this.replaceState(t,e)},t.prototype.replaceState=function(t,e){return null==e&&(e=location.href),this.Histo.supplementState({id:this.id,widgetState:t,path:e})},t.prototype.pushState=function(t,e){return this.Histo.pushNewState(t,{id:this.id,widgetState:e})},t}()},function(t,e,n){t.exports=n(1)}])});